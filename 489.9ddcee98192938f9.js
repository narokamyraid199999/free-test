"use strict";(self.webpackChunkfreePalestine=self.webpackChunkfreePalestine||[]).push([[489],{4489:(w,c,s)=>{s.r(c),s.d(c,{AuthModule:()=>P});var u=s(6814),d=s(3044),e=s(4946),m=s(4104);let f=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-auth"]],decls:8,vars:0,consts:[[1,"bg-black"],[1,"grid","grid-cols-1","gap-x-8","lg:grid-cols-2"],[1,"hidden","lg:block"],["src","assets\\shared\\freePalestine.jpg","alt","",1,"w-full","h-screen"]],template:function(n,l){1&n&&(e._UZ(0,"p-toast"),e.TgZ(1,"section",0)(2,"div",1)(3,"div"),e._UZ(4,"router-outlet"),e.qZA(),e.TgZ(5,"div")(6,"div",2),e._UZ(7,"img",3),e.qZA()()()())},dependencies:[d.lC,m.FN],styles:['@import"https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&family=Permanent+Marker&display=swap";[_ngcontent-%COMP%]::selection{background-color:#ec7755}.merriweather-regular[_ngcontent-%COMP%]{font-family:Merriweather,serif;font-weight:400;font-style:normal}.merriweather-regular-italic[_ngcontent-%COMP%]{font-family:Merriweather,serif;font-weight:400;font-style:italic}.merriweather-bold[_ngcontent-%COMP%]{font-family:Merriweather,serif;font-weight:700;font-style:normal}']})}return i})();var t=s(95),I=s(3625),o=s(5219),a=s(3934),h=s(3714),v=s(336);function x(i,_){1&i&&(e.TgZ(0,"p",20),e._uU(1," * email is required! "),e.qZA())}function Z(i,_){1&i&&(e.TgZ(0,"p",21),e._uU(1," * enter valid email address "),e.qZA())}function U(i,_){if(1&i&&(e.TgZ(0,"div",17),e.YNc(1,x,2,0,"p",18),e.YNc(2,Z,2,0,"p",19),e.qZA()),2&i){const r=e.oxw();let n,l;e.xp6(1),e.Q6J("ngIf",null==(n=r.loginForm.get("email"))?null:n.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(l=r.loginForm.get("email"))?null:l.getError("email"))}}function C(i,_){1&i&&(e.TgZ(0,"p",21),e._uU(1," * password is required! "),e.qZA())}function A(i,_){1&i&&(e.TgZ(0,"p",21),e._uU(1," * minimum length 8 char "),e.qZA())}function y(i,_){1&i&&(e.TgZ(0,"p",21),e._uU(1," * maximum length 8 char "),e.qZA())}function S(i,_){if(1&i&&(e.TgZ(0,"div",17),e.YNc(1,C,2,0,"p",19),e.YNc(2,A,2,0,"p",19),e.YNc(3,y,2,0,"p",19),e.qZA()),2&i){const r=e.oxw();let n,l,g;e.xp6(1),e.Q6J("ngIf",null==(n=r.loginForm.get("password"))?null:n.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(l=r.loginForm.get("password"))?null:l.getError("minlength")),e.xp6(1),e.Q6J("ngIf",null==(g=r.loginForm.get("password"))?null:g.getError("maxlength"))}}let F=(()=>{class i{constructor(r,n,l,g){this._authService=r,this._Router=n,this._messageService=l,this._userService=g,this.loading=!1,this.loginForm=new t.cw({email:new t.NI("",[t.kI.required,t.kI.email]),password:new t.NI("",[t.kI.required,t.kI.minLength(5),t.kI.maxLength(30)])})}ngOnInit(){this.getUserId()}getUserId(){this._authService.userId.subscribe(r=>{r&&(this.userId=r)})}markAllAsTouched(r){Object.values(r).forEach(n=>{n?.markAsTouched()})}login(){this.markAllAsTouched(this.loginForm.controls),this.loginForm.valid&&!this.loading&&(this.loading=!0,setTimeout(()=>{this._authService.login({...this.loginForm.value,id:this.userId}).subscribe({next:r=>{this.loading=!1;let n=r?.data;console.log(n);let l=n.filter(g=>this.loginForm.controls.email.value.toLowerCase()===g.attributes.email.toLowerCase()&&this.loginForm.controls.password.value.toLowerCase()===g.attributes.password.toLowerCase());if(l.length>0){let[g]=l;this._authService.userId.next(g.id),localStorage.setItem("token",JSON.stringify(this.userId)),this._userService.logedInUserId.next(this.userId),console.log("loged in user id",this.userId),this._authService.updateLoginState(),this._authService.loginState.next(!0),this._messageService.add({severity:"success",summary:"Success",detail:"user successfully logged in"}),this._Router.navigate(["/main"])}else this.loading=!1,this._messageService.add({severity:"error",detail:"incorrect username or password"}),this.loginForm.setValue({email:"",password:""}),setTimeout(()=>{this.messages=[]},7e3)},error:r=>{console.log("login error ",r),this.loading=!1,this._messageService.add({severity:"error",detail:`${r?.error?.message}`}),setTimeout(()=>{this.messages=[]},5e3)}})},1e3))}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(I.N),e.Y36(d.F0),e.Y36(o.ez),e.Y36(a.K))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-login"]],decls:30,vars:4,consts:[[1,"container","text-white","mx-auto"],[1,"flex","flex-col","items-center","justify-center","w-full","h-screen"],[1,"text-4xl","flex","items-center","gap-x-2","font-medium","mb-12","permanent-marker-regular"],["src","https://sisksaapp.aou.edu.kw/AOUSISPLS/images/flag-8.png","alt","",1,"w-8","select-none"],[1,""],[1,"text-3xl","font-bold","mb-3","merriweather-regular"],[1,"text-md","text-gray-400"],[1,"my-6",3,"formGroup"],[1,"mb-2","merriweather-regular"],[1,"text-red-400"],["pInputText","","id","email","formControlName","email","type","email",1,"w-[30rem]","bg-zinc-800","h-14","text-white","rounded-md","border-zinc-800"],["class","p-2",4,"ngIf"],[1,"mt-6"],["pInputText","","id","password","formControlName","password","type","password",1,"w-[30rem]","bg-zinc-800","h-14","text-white","rounded-md","border-zinc-800"],["styleClass","w-[30rem] bg-violet-500 border-violet-500 mt-6 merriweather-regular","label","Login",3,"loading","onClick"],[1,"text-center","mt-6","font-light","text-lg"],["routerLink","/auth/signup",1,"text-violet-500"],[1,"p-2"],["class","capitalize block p-error",4,"ngIf"],["class","capitalize p-error",4,"ngIf"],[1,"capitalize","block","p-error"],[1,"capitalize","p-error"]],template:function(n,l){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._UZ(3,"img",3),e.TgZ(4,"span",4),e._uU(5,"FreePalestine"),e.qZA()(),e.TgZ(6,"p",5),e._uU(7," Log in to your account "),e.qZA(),e.TgZ(8,"p",6),e._uU(9,"welcome back! please enter details."),e.qZA(),e.TgZ(10,"form",7)(11,"div")(12,"p",8),e._uU(13," Email"),e.TgZ(14,"span",9),e._uU(15," *"),e.qZA()(),e._UZ(16,"input",10),e.YNc(17,U,3,2,"div",11),e.qZA(),e.TgZ(18,"div",12)(19,"p",8),e._uU(20," Password"),e.TgZ(21,"span",9),e._uU(22," *"),e.qZA()(),e._UZ(23,"input",13),e.YNc(24,S,4,3,"div",11),e.qZA(),e.TgZ(25,"p-button",14),e.NdJ("onClick",function(){return l.login()}),e.qZA(),e.TgZ(26,"p",15),e._uU(27," Don't have an account? "),e.TgZ(28,"a",16),e._uU(29,"Sign Up"),e.qZA()()()()()),2&n){let g,p;e.xp6(10),e.Q6J("formGroup",l.loginForm),e.xp6(7),e.Q6J("ngIf",(null==(g=l.loginForm.get("email"))?null:g.errors)&&(null==(g=l.loginForm.get("email"))?null:g.touched)),e.xp6(7),e.Q6J("ngIf",(null==(p=l.loginForm.get("password"))?null:p.errors)&&(null==(p=l.loginForm.get("password"))?null:p.touched)),e.xp6(1),e.Q6J("loading",l.loading)}},dependencies:[u.O5,d.rH,t._Y,t.Fj,t.JJ,t.JL,t.sg,t.u,h.o,v.zx]})}return i})(),L=(()=>{class i{constructor(r,n,l){this._authService=r,this._Router=n,this._messageService=l,this.regForm=new t.cw({name:new t.NI("",[t.kI.required,t.kI.minLength(5),t.kI.maxLength(30)]),email:new t.NI("",[t.kI.required,t.kI.email]),password:new t.NI("",[t.kI.required,t.kI.minLength(5),t.kI.maxLength(30)]),rePassword:new t.NI("",[t.kI.required,t.kI.minLength(5),t.kI.maxLength(30)]),username:new t.NI("",[t.kI.required,t.kI.minLength(3),t.kI.maxLength(10)])},{validators:this.passwordMatchChecker}),this.loading=!1}passwordMatchChecker(r){let n={};return r.get("password")?.value!=r.get("rePassword")?.value&&(n={passwordmismatch:"password not matched!"},r.get("rePassword")?.setErrors(n)),null}markAllAsTouched(r){Object.values(r).forEach(n=>{n?.markAsTouched()})}signUP(){this.markAllAsTouched(this.regForm.controls),this.regForm.valid&&!this.loading&&(this.loading=!0,setTimeout(()=>{this._authService.login({...this.regForm.value,id:3}).subscribe({next:r=>{this.loading=!1;let n=r?.data;if(console.log(n),n.filter(g=>this.regForm.controls.email.value.toLowerCase()===g.attributes.email.toLowerCase()||this.regForm.controls.username.value.toLowerCase()===g.attributes.username.toLowerCase()).length>0)this.loading=!1,this._messageService.add({severity:"error",detail:"Email or username already registered!"}),this.regForm.setValue({email:"",password:""}),setTimeout(()=>{this.messages=[]},7e3);else{let g={data:{...this.regForm.value}};this._authService.signup(g).subscribe({next:p=>{console.log(p),this.loading=!1,this._Router.navigate(["/auth/login"]),this._messageService.add({severity:"success",summary:"Success",detail:"user successfully logged in"}),setTimeout(()=>{this.messages=[]},5e3)},error:p=>{console.log("login error ",p),this.loading=!1,this._messageService.add({severity:"error",summary:"Error",detail:`${p?.error?.message}`}),setTimeout(()=>{this.messages=[]},5e3)}})}},error:r=>{console.log("login error ",r),this.loading=!1,this._messageService.add({severity:"error",detail:`${r?.error?.message}`}),setTimeout(()=>{this.messages=[]},5e3)}})},1e3))}static#e=this.\u0275fac=function(n){return new(n||i)(e.Y36(I.N),e.Y36(d.F0),e.Y36(o.ez))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-signup"]],decls:46,vars:2,consts:[[1,"container","text-white","mx-auto"],[1,"flex","flex-col","items-center","justify-center","w-full","h-screen"],[1,"text-4xl","flex","items-center","gap-x-2","font-medium","mb-6","permanent-marker-regular"],["src","https://sisksaapp.aou.edu.kw/AOUSISPLS/images/flag-8.png","alt","",1,"w-8","select-none"],[1,""],[1,"text-4xl","font-bold","mb-3","merriweather-regular"],[1,"text-md","text-gray-400"],[1,"mt-6",3,"formGroup"],[1,"mb-2","merriweather-regular"],[1,"text-red-400"],["pInputText","","id","name","formControlName","name","type","text",1,"w-[30rem]","bg-zinc-800","h-14","text-white","rounded-md","border-zinc-800"],[1,"mt-5"],["pInputText","","id","Username","formControlName","username","type","text",1,"w-[30rem]","bg-zinc-800","h-14","text-white","rounded-md","border-zinc-800"],["pInputText","","id","email","formControlName","email","type","email",1,"w-[30rem]","bg-zinc-800","h-14","text-white","rounded-md","border-zinc-800"],["pInputText","","id","password","formControlName","password","type","password",1,"w-[30rem]","bg-zinc-800","h-14","text-white","rounded-md","border-zinc-800"],["pInputText","","id","password","formControlName","rePassword","type","password",1,"w-[30rem]","bg-zinc-800","h-14","text-white","rounded-md","border-zinc-800"],["styleClass","w-[30rem] bg-violet-400 border-violet-400 mt-6 merriweather-regular","label","Sign Up",3,"loading","onClick"],[1,"text-center","mt-6","font-light","text-lg"],["routerLink","/auth/login",1,"text-violet-500"]],template:function(n,l){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._UZ(3,"img",3),e.TgZ(4,"span",4),e._uU(5,"FreePalestine"),e.qZA()(),e.TgZ(6,"p",5),e._uU(7," Create a new account "),e.qZA(),e.TgZ(8,"p",6),e._uU(9," To use freePalestine! please enter details. "),e.qZA(),e.TgZ(10,"form",7)(11,"div")(12,"p",8),e._uU(13," Name"),e.TgZ(14,"span",9),e._uU(15," *"),e.qZA()(),e._UZ(16,"input",10),e.qZA(),e.TgZ(17,"div",11)(18,"p",8),e._uU(19," Username"),e.TgZ(20,"span",9),e._uU(21," *"),e.qZA()(),e._UZ(22,"input",12),e.qZA(),e.TgZ(23,"div",11)(24,"p",8),e._uU(25," Email"),e.TgZ(26,"span",9),e._uU(27," *"),e.qZA()(),e._UZ(28,"input",13),e.qZA(),e.TgZ(29,"div",11)(30,"p",8),e._uU(31," Password"),e.TgZ(32,"span",9),e._uU(33," *"),e.qZA()(),e._UZ(34,"input",14),e.qZA(),e.TgZ(35,"div",11)(36,"p",8),e._uU(37," rePassword"),e.TgZ(38,"span",9),e._uU(39," *"),e.qZA()(),e._UZ(40,"input",15),e.qZA(),e.TgZ(41,"p-button",16),e.NdJ("onClick",function(){return l.signUP()}),e.qZA(),e.TgZ(42,"p",17),e._uU(43," Already have an account? "),e.TgZ(44,"a",18),e._uU(45,"Login"),e.qZA()()()()()),2&n&&(e.xp6(10),e.Q6J("formGroup",l.regForm),e.xp6(31),e.Q6J("loading",l.loading))},dependencies:[d.rH,t._Y,t.Fj,t.JJ,t.JL,t.sg,t.u,h.o,v.zx]})}return i})();var T=s(5505);const E=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"",component:f,children:[{path:"login",canActivate:[T.p],component:F},{path:"signup",canActivate:[T.p],component:L}]}];let k=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(E),d.Bz]})}return i})();var M=s(9862);let P=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({providers:[I.N,o.ez],imports:[u.ez,k,t.u5,t.UX,h.j,M.JF,v.hJ,m.EV]})}return i})()},3934:(w,c,s)=>{s.d(c,{K:()=>f});var u=s(5619),d=s(3625),e=s(4946),m=s(9862);let f=(()=>{class t{constructor(o){this._HttpClient=o,this.userId=new u.X(0),this.logedInUserId=new u.X(0)}upload(o){const a=new FormData;return a.append("ref","api::test.test"),a.append("refid","1"),a.append("field","image"),a.append("files",o),this._HttpClient.post("http://localhost:1337/api/upload",a)}getAllUsers(){return this._HttpClient.get(`${d.F}/api/tests?populate=*&pagination[limit]=300`)}updateUserInfo(o,a){return this._HttpClient.put(`${d.F}/api/tests/${a}?populate=*&pagination[limit]=300`,o)}getUserById(o){return this._HttpClient.get(`${d.F}/api/tests/${o}?populate=*&pagination[limit]=300`)}static#e=this.\u0275fac=function(a){return new(a||t)(e.LFG(m.eN))};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})()},3625:(w,c,s)=>{s.d(c,{F:()=>m,N:()=>f});var u=s(5619),d=s(4946),e=s(9862);const m="http://localhost:1337";let f=(()=>{class t{constructor(o){this.httpClient=o,this.doctorLoginState=new u.X(!1),this.doctorId=new u.X(0),this.loginState=new u.X(!1),this.userId=new u.X(0),this.updateLoginState()}updateLoginState(){let o=localStorage.getItem("token"),a=localStorage.getItem("doctorToken");a&&null!=a&&a.length>0?(this.doctorLoginState.next(!0),this.doctorId.next(parseInt(`${localStorage.getItem("doctorToken")}`))):this.loginState.next(!1),o&&null!=o&&o.length>0?(this.loginState.next(!0),this.userId.next(parseInt(`${localStorage.getItem("token")}`))):this.loginState.next(!1)}login(o){return this.httpClient.get(`${m}/api/tests?populate=*&pagination[limit]=300`)}signup(o){return this.httpClient.post(`${m}/api/tests?populate=*`,o)}updateUserInfo(o){return this.httpClient.put(`${m}/api/patients/${o.data.id}`,o)}static#e=this.\u0275fac=function(a){return new(a||t)(d.LFG(e.eN))};static#t=this.\u0275prov=d.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})()},3714:(w,c,s)=>{s.d(c,{j:()=>f,o:()=>m});var u=s(4946),d=s(6814),e=s(95);let m=(()=>{class t{el;ngModel;cd;filled;constructor(o,a,h){this.el=o,this.ngModel=a,this.cd=h}ngAfterViewInit(){this.updateFilledState(),this.cd.detectChanges()}ngDoCheck(){this.updateFilledState()}onInput(){this.updateFilledState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length||this.ngModel&&this.ngModel.model}static \u0275fac=function(a){return new(a||t)(u.Y36(u.SBq),u.Y36(e.On,8),u.Y36(u.sBO))};static \u0275dir=u.lG2({type:t,selectors:[["","pInputText",""]],hostAttrs:[1,"p-inputtext","p-component","p-element"],hostVars:2,hostBindings:function(a,h){1&a&&u.NdJ("input",function(x){return h.onInput(x)}),2&a&&u.ekj("p-filled",h.filled)}})}return t})(),f=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=u.oAB({type:t});static \u0275inj=u.cJS({imports:[d.ez]})}return t})()}}]);